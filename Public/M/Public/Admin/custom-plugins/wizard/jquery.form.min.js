/*!
 * jQuery Form Plugin
 * version: 3.18 (28-SEP-2012)
 * @requires jQuery v1.5 or later
 *
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Project repository: https://github.com/malsup/form
 * Dual licensed under the MIT and GPL licenses:
 *    http://malsup.github.com/mit-license.txt
 *    http://malsup.github.com/gpl-license-v2.txt
 */
/*global ActiveXObject alert */

;(function(c){function u(a){var e=a.data;a.isDefaultPrevented()||(a.preventDefault(),c(this).ajaxSubmit(e))}function t(a){var e=a.target,g=c(e);if(!g.is(":submit,input:image")){e=g.closest(":submit");if(0===e.length)return;e=e[0]}var b=this;b.clk=e;"image"==e.type&&(void 0!==a.offsetX?(b.clk_x=a.offsetX,b.clk_y=a.offsetY):"function"==typeof c.fn.offset?(g=g.offset(),b.clk_x=a.pageX-g.left,b.clk_y=a.pageY-g.top):(b.clk_x=a.pageX-e.offsetLeft,b.clk_y=a.pageY-e.offsetTop));setTimeout(function(){b.clk=
b.clk_x=b.clk_y=null},100)}function p(){if(c.fn.ajaxSubmit.debug){var a="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(a):window.opera&&window.opera.postError&&window.opera.postError(a)}}var A,B;A=void 0!==c("<input type='file'/>").get(0).files;B=void 0!==window.FormData;c.fn.ajaxSubmit=function(a){function e(b){function e(){function a(){try{var b=(q.contentWindow?q.contentWindow.document:q.contentDocument?q.contentDocument:q.document).readyState;
p("state = "+b);b&&"uninitialized"==b.toLowerCase()&&setTimeout(a,50)}catch(c){p("Server abort: ",c," (",c.name,")"),j(C),t&&clearTimeout(t),t=void 0}}var b=k.attr("target"),h=k.attr("action");f.setAttribute("target",m);g||f.setAttribute("method","POST");h!=d.url&&f.setAttribute("action",d.url);!d.skipEncodingOverride&&(!g||/post/i.test(g))&&k.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});d.timeout&&(t=setTimeout(function(){u=!0;j(y)},d.timeout));var l=[];try{if(d.extraData)for(var i in d.extraData)d.extraData.hasOwnProperty(i)&&
(c.isPlainObject(d.extraData[i])&&d.extraData[i].hasOwnProperty("name")&&d.extraData[i].hasOwnProperty("value")?l.push(c('<input type="hidden" name="'+d.extraData[i].name+'">').attr("value",d.extraData[i].value).appendTo(f)[0]):l.push(c('<input type="hidden" name="'+i+'">').attr("value",d.extraData[i]).appendTo(f)[0]));d.iframeTarget||(w.appendTo("body"),q.attachEvent?q.attachEvent("onload",j):q.addEventListener("load",j,!1));setTimeout(a,15);f.submit()}finally{f.setAttribute("action",h),b?f.setAttribute("target",
b):k.removeAttr("target"),c(l).remove()}}function j(a){if(!h.aborted&&!B){try{r=q.contentWindow?q.contentWindow.document:q.contentDocument?q.contentDocument:q.document}catch(b){p("cannot access response document: ",b),a=C}if(a===y&&h)h.abort("timeout"),v.reject(h,"timeout");else if(a==C&&h)h.abort("server abort"),v.reject(h,"error","server abort");else if(r&&r.location.href!=d.iframeSrc||u){q.detachEvent?q.detachEvent("onload",j):q.removeEventListener("load",j,!1);var a="success",e;try{if(u)throw"timeout";
var f="xml"==d.dataType||r.XMLDocument||c.isXMLDoc(r);p("isXml="+f);if(!f&&(window.opera&&(null===r.body||!r.body.innerHTML))&&--A){p("requeing onLoad callback, DOM not available");setTimeout(j,250);return}var g=r.body?r.body:r.documentElement;h.responseText=g?g.innerHTML:null;h.responseXML=r.XMLDocument?r.XMLDocument:r;f&&(d.dataType="xml");h.getResponseHeader=function(a){return{"content-type":d.dataType}[a]};g&&(h.status=Number(g.getAttribute("status"))||h.status,h.statusText=g.getAttribute("statusText")||
h.statusText);var i=(d.dataType||"").toLowerCase(),k=/(json|script|text)/.test(i);if(k||d.textarea){var m=r.getElementsByTagName("textarea")[0];if(m)h.responseText=m.value,h.status=Number(m.getAttribute("status"))||h.status,h.statusText=m.getAttribute("statusText")||h.statusText;else if(k){var n=r.getElementsByTagName("pre")[0],D=r.getElementsByTagName("body")[0];n?h.responseText=n.textContent?n.textContent:n.innerText:D&&(h.responseText=D.textContent?D.textContent:D.innerText)}}else"xml"==i&&(!h.responseXML&&
h.responseText)&&(h.responseXML=E(h.responseText));try{var f=h,g=d,s=f.getResponseHeader("content-type")||"",F="xml"===i||!i&&0<=s.indexOf("xml"),x=F?f.responseXML:f.responseText;F&&"parsererror"===x.documentElement.nodeName&&c.error&&c.error("parsererror");g&&g.dataFilter&&(x=g.dataFilter(x,i));"string"===typeof x&&("json"===i||!i&&0<=s.indexOf("json")?x=H(x):("script"===i||!i&&0<=s.indexOf("javascript"))&&c.globalEval(x));z=x}catch(I){a="parsererror",h.error=e=I||a}}catch(G){p("error caught: ",
G),a="error",h.error=e=G||a}h.aborted&&(p("upload aborted"),a=null);h.status&&(a=200<=h.status&&300>h.status||304===h.status?"success":"error");"success"===a?(d.success&&d.success.call(d.context,z,"success",h),v.resolve(h.responseText,"success",h),l&&c.event.trigger("ajaxSuccess",[h,d])):a&&(void 0===e&&(e=h.statusText),d.error&&d.error.call(d.context,h,a,e),v.reject(h,"error",e),l&&c.event.trigger("ajaxError",[h,d,e]));l&&c.event.trigger("ajaxComplete",[h,d]);l&&!--c.active&&c.event.trigger("ajaxStop");
d.complete&&d.complete.call(d.context,h,a);B=!0;d.timeout&&clearTimeout(t);setTimeout(function(){d.iframeTarget||w.remove();h.responseXML=null},100)}}}var f=k[0],i,d,l,m,w,q,h,s,u,t;s=!!c.fn.prop;var v=c.Deferred();if(c(":input[name=submit],:input[id=submit]",f).length)return alert('Error: Form elements must not have name or id of "submit".'),v.reject(),v;if(b)for(i=0;i<n.length;i++)b=c(n[i]),s?b.prop("disabled",!1):b.removeAttr("disabled");d=c.extend(!0,{},c.ajaxSettings,a);d.context=d.context||
d;m="jqFormIO"+(new Date).getTime();d.iframeTarget?(w=c(d.iframeTarget),(b=w.attr("name"))?m=b:w.attr("name",m)):(w=c('<iframe name="'+m+'" src="'+d.iframeSrc+'" />'),w.css({position:"absolute",top:"-1000px",left:"-1000px"}));q=w[0];h={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(a){var b="timeout"===a?"timeout":"aborted";p("aborting upload... "+b);this.aborted=
1;if(q.contentWindow.document.execCommand)try{q.contentWindow.document.execCommand("Stop")}catch(e){}w.attr("src",d.iframeSrc);h.error=b;d.error&&d.error.call(d.context,h,b,a);l&&c.event.trigger("ajaxError",[h,d,b]);d.complete&&d.complete.call(d.context,h,b)}};(l=d.global)&&0===c.active++&&c.event.trigger("ajaxStart");l&&c.event.trigger("ajaxSend",[h,d]);if(d.beforeSend&&!1===d.beforeSend.call(d.context,h,d))return d.global&&c.active--,v.reject(),v;if(h.aborted)return v.reject(),v;if(s=f.clk)if((b=
s.name)&&!s.disabled)d.extraData=d.extraData||{},d.extraData[b]=s.value,"image"==s.type&&(d.extraData[b+".x"]=f.clk_x,d.extraData[b+".y"]=f.clk_y);var y=1,C=2;s=c("meta[name=csrf-token]").attr("content");if((b=c("meta[name=csrf-param]").attr("content"))&&s)d.extraData=d.extraData||{},d.extraData[b]=s;d.forceSync?e():setTimeout(e,10);var z,r,A=50,B,E=c.parseXML||function(a,b){window.ActiveXObject?(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)):b=(new DOMParser).parseFromString(a,
"text/xml");return b&&b.documentElement&&"parsererror"!=b.documentElement.nodeName?b:null},H=c.parseJSON||function(a){return window.eval("("+a+")")};return v}if(!this.length)return p("ajaxSubmit: skipping submit process - no element selected"),this;var g,b,k=this;"function"==typeof a&&(a={success:a});g=this.attr("method");b=this.attr("action");(b=(b="string"===typeof b?c.trim(b):"")||window.location.href||"")&&(b=(b.match(/^([^#]+)/)||[])[1]);a=c.extend(!0,{url:b,success:c.ajaxSettings.success,type:g||
"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},a);b={};this.trigger("form-pre-serialize",[this,a,b]);if(b.veto)return p("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(a.beforeSerialize&&!1===a.beforeSerialize(this,a))return p("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var f=a.traditional;void 0===f&&(f=c.ajaxSettings.traditional);var n=[],j,l=this.formToArray(a.semantic,n);a.data&&(a.extraData=a.data,j=c.param(a.data,
f));if(a.beforeSubmit&&!1===a.beforeSubmit(l,this,a))return p("ajaxSubmit: submit aborted via beforeSubmit callback"),this;this.trigger("form-submit-validate",[l,this,a,b]);if(b.veto)return p("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;b=c.param(l,f);j&&(b=b?b+"&"+j:j);"GET"==a.type.toUpperCase()?(a.url+=(0<=a.url.indexOf("?")?"&":"?")+b,a.data=null):a.data=b;var i=[];a.resetForm&&i.push(function(){k.resetForm()});a.clearForm&&i.push(function(){k.clearForm(a.includeHidden)});
if(!a.dataType&&a.target){var C=a.success||function(){};i.push(function(b){var e=a.replaceTarget?"replaceWith":"html";c(a.target)[e](b).each(C,arguments)})}else a.success&&i.push(a.success);a.success=function(b,c,e){for(var g=a.context||this,f=0,d=i.length;f<d;f++)i[f].apply(g,[b,c,e||k,k])};j=0<c("input:file:enabled[value]",this).length;b="multipart/form-data"==k.attr("enctype")||"multipart/form-data"==k.attr("encoding");f=A&&B;p("fileAPI :"+f);var y;if(!1!==a.iframe&&(a.iframe||(j||b)&&!f))a.closeKeepAlive?
c.get(a.closeKeepAlive,function(){y=e(l)}):y=e(l);else if((j||b)&&f){var u=new FormData;for(j=0;j<l.length;j++)u.append(l[j].name,l[j].value);if(a.extraData){j=c.param(a.extraData).split("&");b=j.length;var f={},z,t;for(z=0;z<b;z++)t=j[z].split("="),f[decodeURIComponent(t[0])]=decodeURIComponent(t[1]);for(var m in f)f.hasOwnProperty(m)&&u.append(m,f[m])}a.data=null;m=c.extend(!0,{},c.ajaxSettings,a,{contentType:!1,processData:!1,cache:!1,type:g||"POST"});a.uploadProgress&&(m.xhr=function(){var b=
jQuery.ajaxSettings.xhr();b.upload&&(b.upload.onprogress=function(b){var c=0,e=b.loaded||b.position,f=b.total;b.lengthComputable&&(c=Math.ceil(100*(e/f)));a.uploadProgress(b,e,f,c)});return b});m.data=null;var E=m.beforeSend;m.beforeSend=function(a,b){b.data=u;E&&E.call(this,a,b)};y=c.ajax(m)}else y=c.ajax(a);k.removeData("jqxhr").data("jqxhr",y);for(m=0;m<n.length;m++)n[m]=null;this.trigger("form-submit-notify",[this,a]);return this};c.fn.ajaxForm=function(a){a=a||{};a.delegation=a.delegation&&c.isFunction(c.fn.on);
if(!a.delegation&&0===this.length){var e=this.selector,g=this.context;if(!c.isReady&&e)return p("DOM not ready, queuing ajaxForm"),c(function(){c(e,g).ajaxForm(a)}),this;p("terminating; zero elements found by selector"+(c.isReady?"":" (DOM not ready)"));return this}return a.delegation?(c(document).off("submit.form-plugin",this.selector,u).off("click.form-plugin",this.selector,t).on("submit.form-plugin",this.selector,a,u).on("click.form-plugin",this.selector,a,t),this):this.ajaxFormUnbind().bind("submit.form-plugin",
a,u).bind("click.form-plugin",a,t)};c.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};c.fn.formToArray=function(a,e){var g=[];if(0===this.length)return g;var b=this[0],k=a?b.getElementsByTagName("*"):b.elements;if(!k)return g;var f,n,j,l,i,p;f=0;for(p=k.length;f<p;f++)if(i=k[f],j=i.name)if(a&&b.clk&&"image"==i.type)!i.disabled&&b.clk==i&&(g.push({name:j,value:c(i).val(),type:i.type}),g.push({name:j+".x",value:b.clk_x},{name:j+".y",value:b.clk_y}));else if((l=
c.fieldValue(i,!0))&&l.constructor==Array){e&&e.push(i);n=0;for(i=l.length;n<i;n++)g.push({name:j,value:l[n]})}else if(A&&"file"==i.type&&!i.disabled)if(e&&e.push(i),l=i.files,l.length)for(n=0;n<l.length;n++)g.push({name:j,value:l[n],type:i.type});else g.push({name:j,value:"",type:i.type});else null!==l&&"undefined"!=typeof l&&(e&&e.push(i),g.push({name:j,value:l,type:i.type,required:i.required}));if(!a&&b.clk&&(k=c(b.clk),f=k[0],(j=f.name)&&!f.disabled&&"image"==f.type))g.push({name:j,value:k.val()}),
g.push({name:j+".x",value:b.clk_x},{name:j+".y",value:b.clk_y});return g};c.fn.formSerialize=function(a){return c.param(this.formToArray(a))};c.fn.fieldSerialize=function(a){var e=[];this.each(function(){var g=this.name;if(g){var b=c.fieldValue(this,a);if(b&&b.constructor==Array)for(var k=0,f=b.length;k<f;k++)e.push({name:g,value:b[k]});else null!==b&&"undefined"!=typeof b&&e.push({name:this.name,value:b})}});return c.param(e)};c.fn.fieldValue=function(a){for(var e=[],g=0,b=this.length;g<b;g++){var k=
c.fieldValue(this[g],a);null===k||("undefined"==typeof k||k.constructor==Array&&!k.length)||(k.constructor==Array?c.merge(e,k):e.push(k))}return e};c.fieldValue=function(a,e){var g=a.name,b=a.type,k=a.tagName.toLowerCase();void 0===e&&(e=!0);if(e&&(!g||a.disabled||"reset"==b||"button"==b||("checkbox"==b||"radio"==b)&&!a.checked||("submit"==b||"image"==b)&&a.form&&a.form.clk!=a||"select"==k&&-1==a.selectedIndex))return null;if("select"==k){var f=a.selectedIndex;if(0>f)return null;for(var g=[],k=a.options,
n=(b="select-one"==b)?f+1:k.length,f=b?f:0;f<n;f++){var j=k[f];if(j.selected){var l=j.value;l||(l=j.attributes&&j.attributes.value&&!j.attributes.value.specified?j.text:j.value);if(b)return l;g.push(l)}}return g}return c(a).val()};c.fn.clearForm=function(a){return this.each(function(){c("input,select,textarea",this).clearFields(a)})};c.fn.clearFields=c.fn.clearInputs=function(a){var e=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var g=
this.type,b=this.tagName.toLowerCase();if(e.test(g)||"textarea"==b)this.value="";else if("checkbox"==g||"radio"==g)this.checked=!1;else if("select"==b)this.selectedIndex=-1;else if(a&&(!0===a&&/hidden/.test(g)||"string"==typeof a&&c(this).is(a)))this.value=""})};c.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})};c.fn.enable=function(a){void 0===a&&(a=!0);return this.each(function(){this.disabled=
!a})};c.fn.selected=function(a){void 0===a&&(a=!0);return this.each(function(){var e=this.type;"checkbox"==e||"radio"==e?this.checked=a:"option"==this.tagName.toLowerCase()&&(e=c(this).parent("select"),a&&(e[0]&&"select-one"==e[0].type)&&e.find("option").selected(!1),this.selected=a)})};c.fn.ajaxSubmit.debug=!1})(jQuery);